var dust={};function getGlobal(){return function(){return this.dust}.call(null)}
(function(e){function n(a,f,b){this.stack=a;this.global=f;this.blocks=b}function p(a,f,b,g){this.tail=f;this.isObject=!e.isArray(a)&&a&&"object"===typeof a;this.head=a;this.index=b;this.of=g}function r(a){this.head=new h(this);this.callback=a;this.out=""}function j(){this.head=new h(this)}function h(a,f,b){this.root=a;this.next=f;this.data="";this.flushable=!1;this.taps=b}function a(a,f){this.head=a;this.tail=f}e.cache={};e.register=function(a,f){a&&(e.cache[a]=f)};e.render=function(a,f,b){b=(new r(b)).head;
e.load(a,b,n.wrap(f)).end()};e.stream=function(a,f){var b=new j;e.nextTick(function(){e.load(a,b.head,n.wrap(f)).end()});return b};e.renderSource=function(a,f,b){return e.compileFn(a)(f,b)};e.compileFn=function(a,f){var b=e.loadSource(e.compile(a,f));return function(a,f){var K=f?new r(f):new j;e.nextTick(function(){b(K.head,n.wrap(a)).end()});return K}};e.load=function(a,f,b){var g=e.cache[a];return g?g(f,b):e.onLoad?f.map(function(f){e.onLoad(a,function(g,j){if(g)return f.setError(g);e.cache[a]||
e.loadSource(e.compile(j,a));e.cache[a](f,b).end()})}):f.setError(Error("Template Not Found: "+a))};e.loadSource=function(a){return eval(a)};e.isArray=Array.isArray?Array.isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)};var g;g="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)};e.nextTick=g;e.isEmpty=function(a){return e.isArray(a)&&!a.length?!0:0===a?!1:!a};e.filter=function(a,f,b){if(b)for(var g=0,j=b.length;g<j;g++){var w=b[g];"s"===w?f=null:
a=e.filters[w](a)}f&&(a=e.filters[f](a));return a};e.filters={h:function(a){return e.escapeHtml(a)},j:function(a){return e.escapeJs(a)},u:encodeURI,uc:encodeURIComponent,js:function(a){return!JSON?a:JSON.stringify(a)},jp:function(a){return!JSON?a:JSON.parse(a)}};e.makeBase=function(a){return new n(new p,a)};n.wrap=function(a){return a instanceof n?a:new n(new p(a))};n.prototype.get=function(a){for(var f=this.stack,b;f;){if(f.isObject&&(b=f.head[a],void 0!==b))return b;f=f.tail}return this.global?
this.global[a]:void 0};n.prototype.getPath=function(a,f){var b=this.stack,g=f.length;if(a&&0===g)return b.head;if(b.isObject){for(var b=b.head,j=0;b&&j<g;)b=b[f[j]],j++;return b}};n.prototype.push=function(a,f,b){a&&(a.$idx=f,a.$len=b);return new n(new p(a,this.stack,f,b),this.global,this.blocks)};n.prototype.rebase=function(a){return new n(new p(a),this.global,this.blocks)};n.prototype.current=function(){return this.stack.head};n.prototype.getBlock=function(a,f,b){"function"===typeof a&&(a=a(f,b).data,
f.data="");if(f=this.blocks){b=f.length;for(var g;b--;)if(g=f[b][a])return g}};n.prototype.shiftBlocks=function(a){var f=this.blocks;return a?(newBlocks=f?f.concat([a]):[a],new n(this.stack,this.global,newBlocks)):this};r.prototype.flush=function(){for(var a=this.head;a;){if(a.flushable)this.out+=a.data;else{a.error&&(this.callback(a.error),this.flush=function(){});return}this.head=a=a.next}this.callback(null,this.out)};j.prototype.flush=function(){for(var a=this.head;a;){if(a.flushable)this.emit("data",
a.data);else{a.error&&(this.emit("error",a.error),this.flush=function(){});return}this.head=a=a.next}this.emit("end")};j.prototype.emit=function(a,f){var b=this.events;if(b&&b[a])b[a](f)};j.prototype.on=function(a,f){this.events||(this.events={});this.events[a]=f;return this};j.prototype.pipe=function(a){this.on("data",function(f){a.write(f,"utf8")}).on("end",function(){a.end()}).on("error",function(f){a.error(f)});return this};h.prototype.write=function(a){var f=this.taps;f&&(a=f.go(a));this.data+=
a;return this};h.prototype.end=function(a){a&&this.write(a);this.flushable=!0;this.root.flush();return this};h.prototype.map=function(a){var f=new h(this.root,this.next,this.taps),b=new h(this.root,f,this.taps);this.next=b;this.flushable=!0;a(b);return f};h.prototype.tap=function(f){var b=this.taps;this.taps=b?b.push(f):new a(f);return this};h.prototype.untap=function(){this.taps=this.taps.tail;return this};h.prototype.render=function(a,f){return a(this,f)};h.prototype.reference=function(a,f,b,g){return"function"===
typeof a&&(a=a(this,f,null,{auto:b,filters:g}),a instanceof h)?a:e.isEmpty(a)?this:this.write(e.filter(a,b,g))};h.prototype.section=function(a,f,b,g){if("function"===typeof a&&(a=a(this,f,b,g),a instanceof h))return a;var j=b.block;b=b["else"];g&&(f=f.push(g));if(e.isArray(a)){if(j){g=a.length;b=this;for(var w=0;w<g;w++)b=j(b,f.push(a[w],w,g));return b}}else if(!0===a){if(j)return j(this,f)}else if(a||0===a){if(j)return j(this,f.push(a))}else if(b)return b(this,f);return this};h.prototype.exists=
function(a,f,b){var g=b.block;b=b["else"];if(e.isEmpty(a)){if(b)return b(this,f)}else if(g)return g(this,f);return this};h.prototype.notexists=function(a,f,b){var g=b.block;b=b["else"];if(e.isEmpty(a)){if(g)return g(this,f)}else if(b)return b(this,f);return this};h.prototype.block=function(a,f,b){b=b.block;a&&(b=a);return b?b(this,f):this};h.prototype.partial=function(a,f,b){var g=f.stack,j=g.head;b&&(f=f.rebase(g.tail),f=f.push(b),f=f.push(j));return"function"===typeof a?this.capture(a,f,function(a,
b){e.load(a,b,f).end()}):e.load(a,this,f)};h.prototype.helper=function(a,f,b,g){return e.helpers[a](this,f,b,g)};h.prototype.capture=function(a,f,b){return this.map(function(g){var j=new r(function(a,f){a?g.setError(a):b(f,g)});a(j.head,f).end()})};h.prototype.setError=function(a){this.error=a;this.root.flush();return this};a.prototype.push=function(f){return new a(f,this)};a.prototype.go=function(a){for(var f=this;f;)a=f.head(a),f=f.tail;return a};var f=RegExp(/[&<>\"\']/),b=/&/g,ba=/</g,w=/>/g,
D=/\"/g,S=/\'/g;e.escapeHtml=function(a){return"string"===typeof a?!f.test(a)?a:a.replace(b,"&amp;").replace(ba,"&lt;").replace(w,"&gt;").replace(D,"&quot;").replace(S,"&#39;"):a};var E=/\\/g,M=/\r/g,F=/\u2028/g,z=/\u2029/g,H=/\n/g,I=/\f/g,x=/'/g,A=/"/g,N=/\t/g;e.escapeJs=function(a){return"string"===typeof a?a.replace(E,"\\\\").replace(A,'\\"').replace(x,"\\'").replace(M,"\\r").replace(F,"\\u2028").replace(z,"\\u2029").replace(H,"\\n").replace(I,"\\f").replace(N,"\\t"):a}})(dust);
"undefined"!==typeof exports&&(dust.helpers=require("./dust-helpers").helpers,"undefined"!==typeof process&&require("./server")(dust),module.exports=dust);
(function(e){function n(a){a=a.current();return"object"===typeof a&&!0===a.isSelect}function p(a,g,f,b,j){b=b||{};var e,D;if(b.key)e=g.get(b.key);else if(n(g))e=g.current().value,g.current().isResolved&&(j=function(){return!1});else throw"No key specified for filter and no key found in context from select statement";D=h.tap(b.value,a,g);return j(D,r(e,b.type,g))?(n(g)&&(g.current().isResolved=!0),a.render(f.block,g)):f["else"]?a.render(f["else"],g):a.write("")}function r(a,g,f){if(a)switch(g||typeof a){case "number":return+a;
case "string":return String(a);case "boolean":return Boolean(a);case "date":return new Date(a);case "context":return f.get(a)}return a}var j="undefined"!==typeof console?console:{log:function(){}},h={sep:function(a,g,f){return g.stack.index===g.stack.of-1?a:f.block(a,g)},idx:function(a,g,f){return f.block(a,g.push(g.stack.index))},contextDump:function(a,g){j.log(JSON.stringify(g.stack));return a},tap:function(a,g,f){var b=a;"function"===typeof a&&(b="",g.tap(function(a){b+=a;return""}).render(a,f).untap(),
""===b&&(b=!1));return b},"if":function(a,g,f,b){if(b&&b.cond){b=b.cond;b=this.tap(b,a,g);if(eval(b))return a.render(f.block,g);if(f["else"])return a.render(f["else"],g)}else j.log("NO condition given in the if helper!");return a},select:function(a,g,f,b){if(b&&b.key)return b=b.key,b=this.tap(b,a,g),a.render(f.block,g.push({isSelect:!0,isResolved:!1,value:g.get(b)}));j.log("No key given for the select tag!");return a},eq:function(a,g,f,b){return p(a,g,f,b,function(a,f){return f===a})},lt:function(a,
g,f,b){return p(a,g,f,b,function(a,f){return f<a})},lte:function(a,g,f,b){return p(a,g,f,b,function(a,f){return f<=a})},gt:function(a,g,f,b){return p(a,g,f,b,function(a,f){return f>a})},gte:function(a,g,f,b){return p(a,g,f,b,function(a,f){return f>=a})},"else":function(a,g,f,b){return p(a,g,f,b,function(){return!0})}};e.helpers=h})("undefined"!==typeof exports?exports:getGlobal());
(function(e){function n(a,b){for(var g=[b[0]],j=1,h=b.length;j<h;j++){var n=e.filterNode(a,b[j]);n&&g.push(n)}return g}function p(a,b){return b}function r(){}function j(a,b){for(var g="",j=1,h=b.length;j<h;j++)g+=e.compileNode(a,b[j]);return g}function h(a,b,g){return"."+g+"("+e.compileNode(a,b[1])+","+e.compileNode(a,b[2])+","+e.compileNode(a,b[4])+","+e.compileNode(a,b[3])+")"}e.compile=function(a,b){try{var g,j=e.parse(a);g=e.filterNode({},j);var j={name:b,bodies:[],blocks:{},index:0,auto:"h"},
h="(function(){dust.register("+(b?'"'+b+'"':"null")+","+e.compileNode(j,g)+");",n;g=[];var E=j.blocks,p;for(p in E)g.push(p+":"+E[p]);g.length?(j.blocks="ctx=ctx.shiftBlocks(blocks);",n="var blocks={"+g.join(",")+"};"):n=j.blocks="";var h=h+n,r;n=[];for(var z=j.bodies,H=j.blocks,j=0,I=z.length;j<I;j++)n[j]="function body_"+j+"(chk,ctx){"+H+"return chk"+z[j]+";}";r=n.join("");return h+r+"return body_0;})();"}catch(x){if(!x.line||!x.column)throw x;throw new SyntaxError(x.message+" At line : "+x.line+
", column : "+x.column);}};e.filterNode=function(a,b){return e.optimizers[b[0]](a,b)};e.optimizers={body:function(a,b){for(var g=[b[0]],j,n=1,h=b.length;n<h;n++){var p=e.filterNode(a,b[n]);p&&("buffer"===p[0]?j?j[1]+=p[1]:(j=p,g.push(p)):(j=null,g.push(p)))}return g},buffer:p,special:function(f,b){return["buffer",a[b[1]]]},format:r,reference:n,"#":n,"?":n,"^":n,"<":n,"+":n,"@":n,"%":n,partial:n,context:n,params:n,bodies:n,param:n,filters:p,key:p,path:p,literal:p,comment:r};e.pragmas={esc:function(a,
b,g){var e=a.auto;b||(b="h");a.auto="s"===b?"":b;b=j(a,g.block);a.auto=e;return b}};var a={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};e.compileNode=function(a,b){return e.nodes[b[0]](a,b)};e.nodes={body:function(a,b){var g=a.index++,e="body_"+g;a.bodies[g]=j(a,b);return e},buffer:function(a,b){return".write("+g(b[1])+")"},format:function(a,b){return".write("+g(b[1]+b[2])+")"},reference:function(a,b){return".reference("+e.compileNode(a,b[1])+",ctx,"+e.compileNode(a,b[2])+")"},"#":function(a,b){return h(a,
b,"section")},"?":function(a,b){return h(a,b,"exists")},"^":function(a,b){return h(a,b,"notexists")},"<":function(a,b){for(var g=b[4],j=1,n=g.length;j<n;j++){var h=g[j];if("block"===h[1][1]){a.blocks[b[1].text]=e.compileNode(a,h[2]);break}}return""},"+":function(a,b){return"undefined"===typeof b[1].text&&"undefined"===typeof b[4]?".block(ctx.getBlock("+e.compileNode(a,b[1])+",chk, ctx),"+e.compileNode(a,b[2])+", {},"+e.compileNode(a,b[3])+")":".block(ctx.getBlock("+g(b[1].text)+"),"+e.compileNode(a,
b[2])+","+e.compileNode(a,b[4])+","+e.compileNode(a,b[3])+")"},"@":function(a,b){return".helper("+g(b[1].text)+","+e.compileNode(a,b[2])+","+e.compileNode(a,b[4])+","+e.compileNode(a,b[3])+")"},"%":function(a,b){var g=b[1][1];if(!e.pragmas[g])return"";for(var j=b[4],n={},h=1,p=j.length;h<p;h++){var r=j[h];n[r[1][1]]=r[2]}j=b[3];r={};h=1;for(p=j.length;h<p;h++){var F=j[h];r[F[1][1]]=F[2][1]}return e.pragmas[g](a,b[2][1]?b[2][1].text:null,n,r)},partial:function(a,b){return".partial("+e.compileNode(a,
b[1])+","+e.compileNode(a,b[2])+","+e.compileNode(a,b[3])+")"},context:function(a,b){return b[1]?"ctx.rebase("+e.compileNode(a,b[1])+")":"ctx"},params:function(a,b){for(var g=[],j=1,h=b.length;j<h;j++)g.push(e.compileNode(a,b[j]));return g.length?"{"+g.join(",")+"}":"null"},bodies:function(a,b){for(var g=[],j=1,h=b.length;j<h;j++)g.push(e.compileNode(a,b[j]));return"{"+g.join(",")+"}"},param:function(a,b){return e.compileNode(a,b[1])+":"+e.compileNode(a,b[2])},filters:function(a,b){for(var g=[],j=
1,e=b.length;j<e;j++)g.push('"'+b[j]+'"');return'"'+a.auto+'"'+(g.length?",["+g.join(",")+"]":"")},key:function(a,b){return'ctx.get("'+b[1]+'")'},path:function(a,b){for(var g=b[1],j=b[2],e=[],h=0,n=j.length;h<n;h++)e.push('"'+j[h]+'"');return"ctx.getPath("+g+",["+e.join(",")+"])"},literal:function(a,b){return g(b[1])}};var g="undefined"===typeof JSON?function(a){return'"'+e.escapeJs(a)+'"'}:JSON.stringify})("undefined"!==typeof exports?exports:getGlobal());
(function(e){var n,p=function(j){return'"'+j.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'},r={parse:function(j,e){function a(a){var c={},b;for(b in a)c[b]=a[b];return c}function g(a,c){for(var b=a.offset+c,f=a.offset;f<b;f++){var g=j.charAt(f);"\n"===g?(a.seenCR||a.line++,a.column=1,a.seenCR=!1):"\r"===g||"\u2028"===g||"\u2029"===g?(a.line++,
a.column=1,a.seenCR=!0):(a.column++,a.seenCR=!1)}a.offset+=c}function f(d){c.offset<J.offset||(c.offset>J.offset&&(J=a(c),U=[]),U.push(d))}function b(){var d,k,b;b=a(c);d=[];for(k=r();null!==k;)d.push(k),k=r();null!==d&&(d=["body"].concat(d));null===d&&(c=a(b));return d}function r(){var a;a=T();null===a&&(a=w(),null===a&&(a=H(),null===a&&(a=x(),null===a&&(a=z(),null===a&&(a=$())))));return a}function w(){var d,k,t,s,m,e,V,q,h;l++;q=a(c);h=a(c);d=D();if(null!==d){k=[];for(t=u();null!==t;)k.push(t),
t=u();null!==k?(t=y(),null!==t?(s=b(),null!==s?(m=F(),null!==m?(e=S(),null!==e?(V=d[1].text===e.text?"":null,null!==V?d=[d,k,t,s,m,e,V]:(d=null,c=a(h))):(d=null,c=a(h))):(d=null,c=a(h))):(d=null,c=a(h))):(d=null,c=a(h))):(d=null,c=a(h))}else d=null,c=a(h);null!==d&&(k=d[0],t=d[4],t.push(["param",["literal","block"],d[3]]),k.push(t),d=k);null===d&&(c=a(q));if(null===d){q=a(c);h=a(c);d=D();if(null!==d){k=[];for(t=u();null!==t;)k.push(t),t=u();null!==k?(47===j.charCodeAt(c.offset)?(t="/",g(c,1)):(t=
null,0===l&&f('"/"')),null!==t?(s=y(),null!==s?d=[d,k,t,s]:(d=null,c=a(h))):(d=null,c=a(h))):(d=null,c=a(h))}else d=null,c=a(h);null!==d&&(d=d[0],d.push(["bodies"]));null===d&&(c=a(q))}l--;0===l&&null===d&&f("section");return d}function D(){var d,k,b,s,m,e,h,q;h=a(c);q=a(c);d=B();if(null!==d)if(/^[#?^<+@%]/.test(j.charAt(c.offset))?(k=j.charAt(c.offset),g(c,1)):(k=null,0===l&&f("[#?^<+@%]")),null!==k){b=[];for(s=u();null!==s;)b.push(s),s=u();null!==b?(s=A(),null!==s?(m=E(),null!==m?(e=M(),null!==
e?d=[d,k,b,s,m,e]:(d=null,c=a(q))):(d=null,c=a(q))):(d=null,c=a(q))):(d=null,c=a(q))}else d=null,c=a(q);else d=null,c=a(q);null!==d&&(d=[d[1],d[3],d[4],d[5]]);null===d&&(c=a(h));return d}function S(){var d,k,b,s,m,e,h,q;l++;h=a(c);q=a(c);d=B();if(null!==d)if(47===j.charCodeAt(c.offset)?(k="/",g(c,1)):(k=null,0===l&&f('"/"')),null!==k){b=[];for(s=u();null!==s;)b.push(s),s=u();if(null!==b)if(s=A(),null!==s){m=[];for(e=u();null!==e;)m.push(e),e=u();null!==m?(e=y(),null!==e?d=[d,k,b,s,m,e]:(d=null,c=
a(q))):(d=null,c=a(q))}else d=null,c=a(q);else d=null,c=a(q)}else d=null,c=a(q);else d=null,c=a(q);null!==d&&(d=d[3]);null===d&&(c=a(h));l--;0===l&&null===d&&f("end tag");return d}function E(){var d,k,b,s,m;b=a(c);s=a(c);m=a(c);58===j.charCodeAt(c.offset)?(d=":",g(c,1)):(d=null,0===l&&f('":"'));null!==d?(k=A(),null!==k?d=[d,k]:(d=null,c=a(m))):(d=null,c=a(m));null!==d&&(d=d[1]);null===d&&(c=a(s));d=null!==d?d:"";null!==d&&(d=d?["context",d]:["context"]);null===d&&(c=a(b));return d}function M(){var d,
k,b,s,m,e,h,q;l++;e=a(c);d=[];h=a(c);q=a(c);b=u();if(null!==b)for(k=[];null!==b;)k.push(b),b=u();else k=null;null!==k?(b=v(),null!==b?(61===j.charCodeAt(c.offset)?(s="=",g(c,1)):(s=null,0===l&&f('"="')),null!==s?(m=N(),null===m&&(m=A(),null===m&&(m=R())),null!==m?k=[k,b,s,m]:(k=null,c=a(q))):(k=null,c=a(q))):(k=null,c=a(q))):(k=null,c=a(q));null!==k&&(k=["param",["literal",k[1]],k[3]]);for(null===k&&(c=a(h));null!==k;){d.push(k);h=a(c);q=a(c);b=u();if(null!==b)for(k=[];null!==b;)k.push(b),b=u();else k=
null;null!==k?(b=v(),null!==b?(61===j.charCodeAt(c.offset)?(s="=",g(c,1)):(s=null,0===l&&f('"="')),null!==s?(m=N(),null===m&&(m=A(),null===m&&(m=R())),null!==m?k=[k,b,s,m]:(k=null,c=a(q))):(k=null,c=a(q))):(k=null,c=a(q))):(k=null,c=a(q));null!==k&&(k=["param",["literal",k[1]],k[3]]);null===k&&(c=a(h))}null!==d&&(d=["params"].concat(d));null===d&&(c=a(e));l--;0===l&&null===d&&f("params");return d}function F(){var d,k,t,e,m,h,n,q,p;l++;n=a(c);d=[];q=a(c);p=a(c);k=B();null!==k?(58===j.charCodeAt(c.offset)?
(t=":",g(c,1)):(t=null,0===l&&f('":"')),null!==t?(e=v(),null!==e?(m=y(),null!==m?(h=b(),null!==h?k=[k,t,e,m,h]:(k=null,c=a(p))):(k=null,c=a(p))):(k=null,c=a(p))):(k=null,c=a(p))):(k=null,c=a(p));null!==k&&(k=["param",["literal",k[2]],k[4]]);for(null===k&&(c=a(q));null!==k;)d.push(k),q=a(c),p=a(c),k=B(),null!==k?(58===j.charCodeAt(c.offset)?(t=":",g(c,1)):(t=null,0===l&&f('":"')),null!==t?(e=v(),null!==e?(m=y(),null!==m?(h=b(),null!==h?k=[k,t,e,m,h]:(k=null,c=a(p))):(k=null,c=a(p))):(k=null,c=a(p))):
(k=null,c=a(p))):(k=null,c=a(p)),null!==k&&(k=["param",["literal",k[2]],k[4]]),null===k&&(c=a(q));null!==d&&(d=["bodies"].concat(d));null===d&&(c=a(n));l--;0===l&&null===d&&f("bodies");return d}function z(){var d,k,b,g,j,e;l++;j=a(c);e=a(c);d=B();null!==d?(k=A(),null!==k?(b=I(),null!==b?(g=y(),null!==g?d=[d,k,b,g]:(d=null,c=a(e))):(d=null,c=a(e))):(d=null,c=a(e))):(d=null,c=a(e));null!==d&&(d=["reference",d[1],d[2]]);null===d&&(c=a(j));l--;0===l&&null===d&&f("reference");return d}function H(){var d,
k,b,e,m,h,n,q,p,r;l++;p=a(c);r=a(c);d=B();if(null!==d)if(62===j.charCodeAt(c.offset)?(k=">",g(c,1)):(k=null,0===l&&f('">"')),null===k&&(43===j.charCodeAt(c.offset)?(k="+",g(c,1)):(k=null,0===l&&f('"+"'))),null!==k)if(e=a(c),b=v(),null!==b&&(b=["literal",b]),null===b&&(c=a(e)),null===b&&(b=R()),null!==b)if(e=E(),null!==e)if(m=M(),null!==m){h=[];for(n=u();null!==n;)h.push(n),n=u();null!==h?(47===j.charCodeAt(c.offset)?(n="/",g(c,1)):(n=null,0===l&&f('"/"')),null!==n?(q=y(),null!==q?d=[d,k,b,e,m,h,n,
q]:(d=null,c=a(r))):(d=null,c=a(r))):(d=null,c=a(r))}else d=null,c=a(r);else d=null,c=a(r);else d=null,c=a(r);else d=null,c=a(r);else d=null,c=a(r);null!==d&&(d=[">"===d[1]?"partial":d[1],d[2],d[3],d[4]]);null===d&&(c=a(p));l--;0===l&&null===d&&f("partial");return d}function I(){var d,k,b,e,m,h;l++;e=a(c);d=[];m=a(c);h=a(c);124===j.charCodeAt(c.offset)?(k="|",g(c,1)):(k=null,0===l&&f('"|"'));null!==k?(b=v(),null!==b?k=[k,b]:(k=null,c=a(h))):(k=null,c=a(h));null!==k&&(k=k[1]);for(null===k&&(c=a(m));null!==
k;)d.push(k),m=a(c),h=a(c),124===j.charCodeAt(c.offset)?(k="|",g(c,1)):(k=null,0===l&&f('"|"')),null!==k?(b=v(),null!==b?k=[k,b]:(k=null,c=a(h))):(k=null,c=a(h)),null!==k&&(k=k[1]),null===k&&(c=a(m));null!==d&&(d=["filters"].concat(d));null===d&&(c=a(e));l--;0===l&&null===d&&f("filters");return d}function x(){var d,k,b,e,m,h;l++;m=a(c);h=a(c);d=B();null!==d?(126===j.charCodeAt(c.offset)?(k="~",g(c,1)):(k=null,0===l&&f('"~"')),null!==k?(b=v(),null!==b?(e=y(),null!==e?d=[d,k,b,e]:(d=null,c=a(h))):(d=
null,c=a(h))):(d=null,c=a(h))):(d=null,c=a(h));null!==d&&(d=["special",d[2]]);null===d&&(c=a(m));l--;0===l&&null===d&&f("special");return d}function A(){var d,k;l++;k=a(c);d=Z();if(null!==d){var b=["path"].concat(d);b.text=d[1].join(".");d=b}null===d&&(c=a(k));null===d&&(k=a(c),d=v(),null!==d&&(b=["key",d],b.text=d,d=b),null===d&&(c=a(k)));l--;0===l&&null===d&&f("identifier");return d}function N(){var d,k;l++;k=a(c);d=K();null===d&&(d=L());null!==d&&(d=["literal",d]);null===d&&(c=a(k));l--;0===l&&
null===d&&f("number");return d}function K(){var d,k,b,e,m,h;l++;m=a(c);h=a(c);d=L();if(null!==d)if(46===j.charCodeAt(c.offset)?(k=".",g(c,1)):(k=null,0===l&&f('"."')),null!==k){e=L();if(null!==e)for(b=[];null!==e;)b.push(e),e=L();else b=null;null!==b?d=[d,k,b]:(d=null,c=a(h))}else d=null,c=a(h);else d=null,c=a(h);null!==d&&(d=parseFloat(d[0]+"."+d[2].join("")));null===d&&(c=a(m));l--;0===l&&null===d&&f("frac");return d}function L(){var d,b,e;l++;e=a(c);/^[0-9]/.test(j.charAt(c.offset))?(b=j.charAt(c.offset),
g(c,1)):(b=null,0===l&&f("[0-9]"));if(null!==b)for(d=[];null!==b;)d.push(b),/^[0-9]/.test(j.charAt(c.offset))?(b=j.charAt(c.offset),g(c,1)):(b=null,0===l&&f("[0-9]"));else d=null;null!==d&&(d=parseInt(d.join(""),10));null===d&&(c=a(e));l--;0===l&&null===d&&f("integer");return d}function Z(){var d,b,e,h,m;l++;h=a(c);m=a(c);d=v();d=null!==d?d:"";if(null!==d){e=P();null===e&&(e=Q());if(null!==e)for(b=[];null!==e;)b.push(e),e=P(),null===e&&(e=Q());else b=null;null!==b?d=[d,b]:(d=null,c=a(m))}else d=null,
c=a(m);null!==d&&(b=d[0],d=d[1],d=d[0],b&&d?(d.unshift(b),d=[!1,d]):d=[!0,d]);null===d&&(c=a(h));null===d&&(h=a(c),46===j.charCodeAt(c.offset)?(d=".",g(c,1)):(d=null,0===l&&f('"."')),null!==d&&(d=[!0,[]]),null===d&&(c=a(h)));l--;0===l&&null===d&&f("path");return d}function v(){var d,b,e,h,m;l++;h=a(c);m=a(c);/^[a-zA-Z_$]/.test(j.charAt(c.offset))?(d=j.charAt(c.offset),g(c,1)):(d=null,0===l&&f("[a-zA-Z_$]"));if(null!==d){b=[];/^[0-9a-zA-Z_$]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):
(e=null,0===l&&f("[0-9a-zA-Z_$]"));for(;null!==e;)b.push(e),/^[0-9a-zA-Z_$]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):(e=null,0===l&&f("[0-9a-zA-Z_$]"));null!==b?d=[d,b]:(d=null,c=a(m))}else d=null,c=a(m);null!==d&&(d=d[0]+d[1].join(""));null===d&&(c=a(h));l--;0===l&&null===d&&f("key");return d}function P(){var d,b,e,h,m,n,p;l++;h=a(c);m=a(c);n=a(c);p=a(c);46===j.charCodeAt(c.offset)?(b=".",g(c,1)):(b=null,0===l&&f('"."'));null!==b?(e=v(),null!==e?b=[b,e]:(b=null,c=a(p))):(b=null,c=
a(p));null!==b&&(b=b[1]);null===b&&(c=a(n));if(null!==b)for(d=[];null!==b;)d.push(b),n=a(c),p=a(c),46===j.charCodeAt(c.offset)?(b=".",g(c,1)):(b=null,0===l&&f('"."')),null!==b?(e=v(),null!==e?b=[b,e]:(b=null,c=a(p))):(b=null,c=a(p)),null!==b&&(b=b[1]),null===b&&(c=a(n));else d=null;null!==d?(b=Q(),b=null!==b?b:"",null!==b?d=[d,b]:(d=null,c=a(m))):(d=null,c=a(m));null!==d&&(d=d[1]?d[0].concat(d[1]):d[0]);null===d&&(c=a(h));l--;0===l&&null===d&&f("nestedKey");return d}function Q(){var d,b,e,h,m,n,p;
l++;h=a(c);m=a(c);n=a(c);p=a(c);91===j.charCodeAt(c.offset)?(d="[",g(c,1)):(d=null,0===l&&f('"["'));if(null!==d){/^[0-9]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):(e=null,0===l&&f("[0-9]"));if(null!==e)for(b=[];null!==e;)b.push(e),/^[0-9]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):(e=null,0===l&&f("[0-9]"));else b=null;null!==b?(93===j.charCodeAt(c.offset)?(e="]",g(c,1)):(e=null,0===l&&f('"]"')),null!==e?d=[d,b,e]:(d=null,c=a(p))):(d=null,c=a(p))}else d=null,c=a(p);null!==
d&&(d=d[1].join(""));null===d&&(c=a(n));null!==d?(b=P(),b=null!==b?b:"",null!==b?d=[d,b]:(d=null,c=a(m))):(d=null,c=a(m));null!==d&&(b=d[0],(d=d[1])?d.unshift(b):d=[b]);null===d&&(c=a(h));l--;0===l&&null===d&&f("array");return d}function R(){var d,b,e,h,m;l++;h=a(c);m=a(c);34===j.charCodeAt(c.offset)?(d='"',g(c,1)):(d=null,0===l&&f('"\\""'));null!==d?(34===j.charCodeAt(c.offset)?(b='"',g(c,1)):(b=null,0===l&&f('"\\""')),null!==b?d=[d,b]:(d=null,c=a(m))):(d=null,c=a(m));null!==d&&(d=["literal",""]);
null===d&&(c=a(h));if(null===d&&(h=a(c),m=a(c),34===j.charCodeAt(c.offset)?(d='"',g(c,1)):(d=null,0===l&&f('"\\""')),null!==d?(b=W(),null!==b?(34===j.charCodeAt(c.offset)?(e='"',g(c,1)):(e=null,0===l&&f('"\\""')),null!==e?d=[d,b,e]:(d=null,c=a(m))):(d=null,c=a(m))):(d=null,c=a(m)),null!==d&&(d=["literal",d[1]]),null===d&&(c=a(h)),null===d)){h=a(c);m=a(c);34===j.charCodeAt(c.offset)?(d='"',g(c,1)):(d=null,0===l&&f('"\\""'));if(null!==d){e=X();if(null!==e)for(b=[];null!==e;)b.push(e),e=X();else b=null;
null!==b?(34===j.charCodeAt(c.offset)?(e='"',g(c,1)):(e=null,0===l&&f('"\\""')),null!==e?d=[d,b,e]:(d=null,c=a(m))):(d=null,c=a(m))}else d=null,c=a(m);null!==d&&(d=["body"].concat(d[1]));null===d&&(c=a(h))}l--;0===l&&null===d&&f("inline");return d}function X(){var d,b;d=x();null===d&&(d=z(),null===d&&(b=a(c),d=W(),null!==d&&(d=["buffer",d]),null===d&&(c=a(b))));return d}function $(){var d,b,e,h,m,n,p,q;l++;n=a(c);p=a(c);d=G();if(null!==d){b=[];for(e=u();null!==e;)b.push(e),e=u();null!==b?d=[d,b]:
(d=null,c=a(p))}else d=null,c=a(p);null!==d&&(d=["format",d[0],d[1].join("")]);null===d&&(c=a(n));if(null===d){n=a(c);p=a(c);q=a(c);m=a(c);l++;b=O();l--;null===b?b="":(b=null,c=a(m));null!==b?(m=a(c),l++,e=G(),l--,null===e?e="":(e=null,c=a(m)),null!==e?(m=a(c),l++,h=T(),l--,null===h?h="":(h=null,c=a(m)),null!==h?(j.length>c.offset?(m=j.charAt(c.offset),g(c,1)):(m=null,0===l&&f("any character")),null!==m?b=[b,e,h,m]:(b=null,c=a(q))):(b=null,c=a(q))):(b=null,c=a(q))):(b=null,c=a(q));null!==b&&(b=b[3]);
null===b&&(c=a(p));if(null!==b)for(d=[];null!==b;)d.push(b),p=a(c),q=a(c),m=a(c),l++,b=O(),l--,null===b?b="":(b=null,c=a(m)),null!==b?(m=a(c),l++,e=G(),l--,null===e?e="":(e=null,c=a(m)),null!==e?(m=a(c),l++,h=T(),l--,null===h?h="":(h=null,c=a(m)),null!==h?(j.length>c.offset?(m=j.charAt(c.offset),g(c,1)):(m=null,0===l&&f("any character")),null!==m?b=[b,e,h,m]:(b=null,c=a(q))):(b=null,c=a(q))):(b=null,c=a(q))):(b=null,c=a(q)),null!==b&&(b=b[3]),null===b&&(c=a(p));else d=null;null!==d&&(d=["buffer",
d.join("")]);null===d&&(c=a(n))}l--;0===l&&null===d&&f("buffer");return d}function W(){var d,b,e,h,m,n;l++;h=a(c);m=a(c);n=a(c);e=a(c);l++;b=O();l--;null===b?b="":(b=null,c=a(e));null!==b?(e=Y(),null===e&&(/^[^"]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):(e=null,0===l&&f('[^"]'))),null!==e?b=[b,e]:(b=null,c=a(n))):(b=null,c=a(n));null!==b&&(b=b[1]);null===b&&(c=a(m));if(null!==b)for(d=[];null!==b;)d.push(b),m=a(c),n=a(c),e=a(c),l++,b=O(),l--,null===b?b="":(b=null,c=a(e)),null!==b?(e=
Y(),null===e&&(/^[^"]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):(e=null,0===l&&f('[^"]'))),null!==e?b=[b,e]:(b=null,c=a(n))):(b=null,c=a(n)),null!==b&&(b=b[1]),null===b&&(c=a(m));else d=null;null!==d&&(d=d.join(""));null===d&&(c=a(h));l--;0===l&&null===d&&f("literal");return d}function Y(){var d,b;b=a(c);'\\"'===j.substr(c.offset,2)?(d='\\"',g(c,2)):(d=null,0===l&&f('"\\\\\\""'));null!==d&&(d='"');null===d&&(c=a(b));return d}function T(){var b,e,h,n,m,p,r,q;l++;m=a(c);p=a(c);"{!"===
j.substr(c.offset,2)?(b="{!",g(c,2)):(b=null,0===l&&f('"{!"'));if(null!==b){e=[];r=a(c);q=a(c);n=a(c);l++;"!}"===j.substr(c.offset,2)?(h="!}",g(c,2)):(h=null,0===l&&f('"!}"'));l--;null===h?h="":(h=null,c=a(n));null!==h?(j.length>c.offset?(n=j.charAt(c.offset),g(c,1)):(n=null,0===l&&f("any character")),null!==n?h=[h,n]:(h=null,c=a(q))):(h=null,c=a(q));null!==h&&(h=h[1]);for(null===h&&(c=a(r));null!==h;)e.push(h),r=a(c),q=a(c),n=a(c),l++,"!}"===j.substr(c.offset,2)?(h="!}",g(c,2)):(h=null,0===l&&f('"!}"')),
l--,null===h?h="":(h=null,c=a(n)),null!==h?(j.length>c.offset?(n=j.charAt(c.offset),g(c,1)):(n=null,0===l&&f("any character")),null!==n?h=[h,n]:(h=null,c=a(q))):(h=null,c=a(q)),null!==h&&(h=h[1]),null===h&&(c=a(r));null!==e?("!}"===j.substr(c.offset,2)?(h="!}",g(c,2)):(h=null,0===l&&f('"!}"')),null!==h?b=[b,e,h]:(b=null,c=a(p))):(b=null,c=a(p))}else b=null,c=a(p);null!==b&&(b=["comment",b[1].join("")]);null===b&&(c=a(m));l--;0===l&&null===b&&f("comment");return b}function O(){var b,e,h,n,m,p,r,q,
v;q=a(c);b=B();if(null!==b)if(/^[#?^><+%:@\/~%]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),g(c,1)):(e=null,0===l&&f("[#?^><+%:@\\/~%]")),null!==e){h=[];for(n=u();null!==n;)h.push(n),n=u();if(null!==h){v=a(c);r=a(c);l++;m=y();l--;null===m?m="":(m=null,c=a(r));null!==m?(r=a(c),l++,p=G(),l--,null===p?p="":(p=null,c=a(r)),null!==p?(j.length>c.offset?(r=j.charAt(c.offset),g(c,1)):(r=null,0===l&&f("any character")),null!==r?m=[m,p,r]:(m=null,c=a(v))):(m=null,c=a(v))):(m=null,c=a(v));if(null!==m)for(n=
[];null!==m;)n.push(m),v=a(c),r=a(c),l++,m=y(),l--,null===m?m="":(m=null,c=a(r)),null!==m?(r=a(c),l++,p=G(),l--,null===p?p="":(p=null,c=a(r)),null!==p?(j.length>c.offset?(r=j.charAt(c.offset),g(c,1)):(r=null,0===l&&f("any character")),null!==r?m=[m,p,r]:(m=null,c=a(v))):(m=null,c=a(v))):(m=null,c=a(v));else n=null;if(null!==n){m=[];for(p=u();null!==p;)m.push(p),p=u();null!==m?(p=y(),null!==p?b=[b,e,h,n,m,p]:(b=null,c=a(q))):(b=null,c=a(q))}else b=null,c=a(q)}else b=null,c=a(q)}else b=null,c=a(q);
else b=null,c=a(q);null===b&&(b=z());return b}function B(){var a;123===j.charCodeAt(c.offset)?(a="{",g(c,1)):(a=null,0===l&&f('"{"'));return a}function y(){var a;125===j.charCodeAt(c.offset)?(a="}",g(c,1)):(a=null,0===l&&f('"}"'));return a}function G(){var a;10===j.charCodeAt(c.offset)?(a="\n",g(c,1)):(a=null,0===l&&f('"\\n"'));null===a&&("\r\n"===j.substr(c.offset,2)?(a="\r\n",g(c,2)):(a=null,0===l&&f('"\\r\\n"')),null===a&&(13===j.charCodeAt(c.offset)?(a="\r",g(c,1)):(a=null,0===l&&f('"\\r"')),
null===a&&(8232===j.charCodeAt(c.offset)?(a="\u2028",g(c,1)):(a=null,0===l&&f('"\\u2028"')),null===a&&(8233===j.charCodeAt(c.offset)?(a="\u2029",g(c,1)):(a=null,0===l&&f('"\\u2029"'))))));return a}function u(){var a;/^[\t\x0B\f \xA0\uFEFF]/.test(j.charAt(c.offset))?(a=j.charAt(c.offset),g(c,1)):(a=null,0===l&&f("[\\t\\x0B\\f \\xA0\\uFEFF]"));null===a&&(a=G());return a}function ca(a){a.sort();for(var b=null,c=[],e=0;e<a.length;e++)a[e]!==b&&(c.push(a[e]),b=a[e]);return c}var C={body:b,part:r,section:w,
sec_tag_start:D,end_tag:S,context:E,params:M,bodies:F,reference:z,partial:H,filters:I,special:x,identifier:A,number:N,frac:K,integer:L,path:Z,key:v,nestedKey:P,array:Q,inline:R,inline_part:X,buffer:$,literal:W,esc:Y,comment:T,tag:O,ld:B,rd:y,eol:G,ws:u};if(void 0!==e){if(void 0===C[e])throw Error("Invalid rule name: "+p(e)+".");}else e="body";var c={offset:0,line:1,column:1,seenCR:!1},l=0,J={offset:0,line:1,column:1,seenCR:!1},U=[],C=C[e]();if(null===C||c.offset!==j.length){var C=Math.max(c.offset,
J.offset),da=C<j.length?j.charAt(C):null,aa=c.offset>J.offset?c:J;throw new n.SyntaxError(ca(U),da,C,aa.line,aa.column);}return C},toSource:function(){return this._source},SyntaxError:function(e,h,a,g,f){this.name="SyntaxError";this.expected=e;this.found=h;switch(e.length){case 0:e="end of input";break;case 1:e=e[0];break;default:e=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}h=h?p(h):"end of input";this.message="Expected "+e+" but "+h+" found.";this.offset=a;this.line=g;this.column=f}};
r.SyntaxError.prototype=Error.prototype;n=r;e.parse=n.parse})("undefined"!==typeof exports?exports:getGlobal());